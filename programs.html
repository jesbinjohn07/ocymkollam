<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Programs - OCYM Kollam</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="style.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
/* ===== PROGRAMS PAGE ONLY ===== */

.programs-section {
  padding: 30px 15px;
  max-width: 900px;
  margin: auto;
}

.programs-section h2 {
  text-align: center;
  color: #0b3c5d;
  margin-bottom: 20px;
}

/* YEAR BLOCK */

.year-block {
  margin-bottom: 18px;
}

.year-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #ffffff;
  padding: 12px 14px;
  border-left: 6px solid #ffd700;
  border-radius: 12px;
  cursor: pointer;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

.year-header span {
  font-weight: 600;
  color: #0b3c5d;
}

.year-header .arrow {
  transition: transform 0.3s ease;
}

/* COLLAPSE */

.year-content {
  display: none;
  margin-top: 14px;
}

.year-block.open .year-content {
  display: block;
}

.year-block.open .arrow {
  transform: rotate(180deg);
}

/* PROGRAM CARD */

.program-card {
  background: #ffffff;
  padding: 14px;
  border-radius: 14px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  margin-bottom: 14px;
}

/* IMAGE (OPTIONAL) */

.program-card img {
  width: 100%;
  max-height: 220px;
  object-fit: cover;
  border-radius: 12px;
  margin-bottom: 10px;
}

/* TEXT */

.program-card h4 {
  margin: 8px 0;
  color: #0b3c5d;
}

.program-card p {
  font-size: 14px;
  color: #555;
  line-height: 1.6;
}

/* FIX DESKTOP MODE WEIRD EXPAND */

.year-content {
  max-width: 900px;
  margin: 14px auto 0;
  padding: 0 10px;
}

@media (min-width: 768px) {
  .program-card {
    display: flex;
    gap: 16px;
    align-items: flex-start;
  }

  .program-card img {
    width: 40%;
    max-height: 240px;
  }

  .program-card h4,
  .program-card p {
    width: 60%;
  }
}
</style>
</head>

<body>

<header>
  <div class="header-box">
    <img src="images/logo.png" class="logo">
    <h1>OCYM Kollam</h1>
    <p class="subtitle">Orthodox Christian Youth Movement</p>
    <p class="diocese">Kollam Diocese</p>
  </div>

  <nav>
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="notice.html">Notice</a> 
    <a href="registration.html">Registration</a>
    <a href="programs.html" class="active">Programs</a>
    <a href="contact.html">Contact</a>
  </nav>
</header>

<main>

<section class="programs-section">
  <h2>✨ OCYM Programs</h2>
  <div id="programsContainer">
  <div class="loader">
    <span></span>
    <span></span>
    <span></span>
    <p>Loading programs…</p>
  </div>
  </div>
</section>

</main>

<footer>
  <p>© 2026 OCYM Kollam</p>
</footer>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzb9l6Ce2ShxIpJccCBZoPxZ-ZCEqyH2twcA5E_fIH2ohvaZGIxycEcF1jqQQ5GWaehaA/exec";

fetch(API_URL)
  .then(res => res.json())
  .then(data => {

    const container = document.getElementById("programsContainer");
    container.innerHTML = "";

    let years = {};

    // group by year
    data.forEach(item => {
      if (!years[item.year]) years[item.year] = [];
      years[item.year].push(item);
    });

    // render years
    Object.keys(years).sort().reverse().forEach(year => {

      let programsHTML = "";

      years[year].forEach(p => {

        // image optional
        const imageHTML = p.image
          ? `<img src="${p.image}" alt="${p.title}" onerror="this.style.display='none'">`
          : "";

        programsHTML += `
          <div class="program-card">
            ${imageHTML}
            <h4>${p.title}</h4>
            <p>${p.description}</p>
          </div>
        `;
      });

      container.innerHTML += `
        <div class="year-block">
          <div class="year-header" onclick="toggleYear(this)">
            <span>${year} Tap to expand</span>
            <span class="arrow">▼</span>
          </div>
          <div class="year-content">
            ${programsHTML}
          </div>
        </div>
      `;
    });
  })
  .catch(() => {
    document.getElementById("programsContainer").innerHTML =
      "<p>❌ Unable to load programs.</p>";
  });

function toggleYear(el) {
  el.parentElement.classList.toggle("open");
}
</script>

</body>
</html>
